## 1. 业务背景

### 1. 分析对象

以市场占有率最⾼高的某滴软件作为分析对象

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf8dx35wxj30e80kctbl.jpg" alt="image-20200401102758155" style="zoom:50%;" />

### 2. 相关方

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf8e4en36j30t80fs79z.jpg" alt="image-20200401102918319" style="zoom: 33%;" />



### 3. 共性分析

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf8e766qwj30wq0ig4a2.jpg" alt="image-20200401102945816" style="zoom:50%;" />

### 4. 非共性分析

<img src="/Users/song/Library/Application Support/typora-user-images/image-20200401103045895.png" alt="image-20200401103045895" style="zoom:50%;" />

### 5. 业务矩阵

<img src="/Users/song/Library/Application Support/typora-user-images/image-20200401103105339.png" alt="image-20200401103105339" style="zoom:50%;" />

### 6 .需求方

<img src="/Users/song/Library/Application Support/typora-user-images/image-20200401103118925.png" alt="image-20200401103118925" style="zoom:50%;" />

### 7. 基础数据

**乘客**

发单数、接单数、⽀支付数、发单时⻓长、做单时⻓长、⽀支付时⻓长、好评数、差评数、会员等级、 基础画像(姓名、性别、年龄、职业、⼿手机号，设备信息、常驻地、⼯工作地等)、⾏行行为画像( 订单偏好、打⻋车时间偏好、出发地偏好、⽬目的地偏好等、乘客信⽤用分、作弊情况)

**司机**

接单数、拒单数、⽀支付数、投诉数、好评数、收⼊入情况、基础画像(姓名、性别、年年龄、职业、 ⼿手机号，设备信息、常驻地、⼯工作地等、⾏行行驶证、驾驶证)、⾏行行为画像(订单偏好、⼯工作时间偏好、 作弊情况、司机服务分)

**车辆**

⻋车辆基础信息、⻋车主信息、保养信息

**平台**

APP平台类型、版本、曝光⽇日志、点击⽇日志、浏览⽇日志



## 2. 指标体系梳理

### 1. 指标和指标体系

**指标**: ⽤来衡量量某一事件的度量值

**指标体系**: 指标+维度



**指标定义三要素** : 统计频率 + 统计周期 + 统计口径

例如: ⽤用户A在今天下了了⼀一个快⻋车单，顺利利到达⽬目的地，并成功⽀支付

**原⼦指标提炼**:下单数、成单数、⽀支付订单数、下单⼈人数、成单⼈人数、⽀支付⼈人数、 乘客⽀支付⾦金金额、平台抽成、司机⽀支付⾦金金额

**维度提炼**:时间、订单类型、⽀支付⽅方式、⻋车辆基础信息、乘客基础信息、司机基础信息 



指标定义(举例):

当⽇下单数:按天统计、下单时间为当天的订单数量量 ⽀支付订单数:按天统计、⽀支付时间为当天且成功⽀支付的订单数量量



### 2. 指标梳理

**唯⼀关键指标(one metric that matters, OMTM)**

- **访问行为指标:**

  下载⽤用户数、注册⽤用户数、⻚页⾯面曝光(PV/UV)、⻚页⾯面浏览(PV/UV)、⻚页⾯面点击(PV/UV)

  ⽤用户停留留时⻓长等 

- **订单⾏为指标:**

  下单(人)数、抢单(人)数、接单(人)数、成单(人)数、⽀支付(人)数、好评数、差评数

  订单⾦额、⽀支付⾦额、优惠券使用金额、退单金额

 - **衍⽣生指标:**

   新增(下单)⽤用户占⽐、抢单率、成单率、⽀支付率、单笔⽤用户消费⾦金金额、 ⼈人均⽤用户消费⾦金金额、优惠券使⽤用占比、⻚面转化率、好评率、差评率



### 3. 维度梳理

- ⼈⼝属性: 

  性别、年龄、职业、城市、学历、星座、收入、爱好、婚姻状况、⼦女状况。。。

- 设备属性**(**⻋辆**)**: 

  ⻋辆品牌、⻋辆型号、⻋辆类型、⻋辆价位

- 设备属性**(**⼿机**)**: 

  手机型号、⼿机品牌、操作系统类型。。。

- ⾏为属性:

   ⽤户类型、会员等级、流失用户标识、活跃用户标识、作弊用户标识、下单城市。。

- 流量属性: 

  渠道信息、⻚面信息、栏位信息





## 3. 实施规范

### 1. 分层模型

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf85r1s0xj31460fedmn.jpg" alt="image-20200401110219311" style="zoom:50%;" />

### 2. 指标举例

![image-20200401110315078](https://tva1.sinaimg.cn/large/00831rSTgy1gdf85odegdj311i0nedmd.jpg)

### 3. 指标定义举例

![image-20200401110342886](https://tva1.sinaimg.cn/large/00831rSTgy1gdf85mlafdj30wk0oqjxe.jpg)



### 4. 设计约定

- 模型复用性

  各业务优先使⽤公⽤ 模型指标，个性化指标可分别设计模型

- 命名规范化

  DWD/DWS层命名只控制头(业务域+数据域)、尾(刷新周期及数据粒度)、ADS层命名:ads_业务域名称...

- 指标统⼀

  指标数据(通⽤用指标、明细、⽐比率等)统⼀一下层到DWD/DWS实现，兼顾性能，原则上不不超过⼀一个半⼩小时



### 5. 层次调用约定

- 应⽤用层优先调⽤用公共层数据

- 已经存在中间层数据，不不允许应⽤用层跨过

- 中间层从ODS层重复加⼯工数据 中间层团队应该积极了了解应⽤用层数据的建设需求，将公⽤用的数据沉淀到公共层，为其他团队提供数据服务 

- 应⽤用层团队也需积极配合中间层团队进⾏行行数据公共层建设的改造和迁移 

- 必须避免过度使⽤用ODS层引⽤用和不不合理理的数据复制和⼦子集合冗余。



### 6. 表命名约定

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf85k8tczj311q0kkas2.jpg" alt="image-20200401110702952" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf85ies7hj31780lo47r.jpg" alt="image-20200401110723247" style="zoom: 40%;" />



### 7. 字段命名规范

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf85gj3x9j31160j4h1f.jpg" alt="image-20200401110751543" style="zoom:50%;" />



### 8. 开发规范

#### 1. 总原则

- 原则上不不能依赖⾮非数据团队节点
- 未获得节点owner许可的情况下，不不能擅⾃自修改别⼈人的节点 

- 不能随意变更节点owner，必须知会接收⼈人并得到同意
-  不能随意变更表owner，必须只会接收⼈人并得到同意



#### 2. 代码文件管理规范

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf85dnzuoj314e0eync5.jpg" alt="image-20200402103630688" style="zoom:50%;" />



#### 3. 注释规范

 **程序头注释部分**
-  注释符[功能Subject-程序完成的功能、试⽤用场合、使⽤用缺陷等详细描述] • 注释符[作者Author-程序开发⼈人员名称]
-  注释符[更新Created-内容及时间]
-  注释符[更更新者&时间&内容:Update]

**代码段注释**

- 每⼀一段代码前必须包含 ⼀一个注释⾏行行

**表注释**

- 每个表填写注释 
- 元数据表详情-标签选择
- 元数据表详情:表使⽤用说明、填写常⻅见的FAQ，使⽤用场景等等

**字段注释**

- 每个字段填写注释

- 分区字段为刷新周期时，填写时间周期格式，为业务分析时，填写业务枚举值及相应的描述 • 字段指可以枚举时，罗列列枚举值以及相应的描述信息

- ⾦额字段填上单位


#### 4.SQL编码规范-总原则

• 代码功能完整、健壮
 • 代码⾏行行清晰、整⻬齐，具有⼀一定的可观赏性
 • 代码编写要充分考虑执⾏行行速度最优的原则
 • 代码⾏行行整体层次分明，结构化强
 • 代码中应有必须的注释以增强代码的可读性
 • 规范要求⾮非强制性约束代码开发⼈人员的代码编写⾏行行为，在实际应⽤用中在不不违反常规要求的前提下允许存在可理理解的偏差 • SQL代码中应⽤用到的所有关键字、保留留字都使⽤用⼤大写，如SELECT、FROM、WHERE、AND、OR、UNION
 • SQL代码中应⽤用到的除关键字、保留留字之外的代码，都使⽤用⼩小写，如字段名，别名等
 • 四个空格为⼀一个缩进量量，所有的缩进皆为⼀一个缩进量量的整数倍，按代码层次对其
 • 对应的括号要求在同⼀一列列的位置上

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf859xtsij30p00m241n.jpg" alt="image-20200402104026073" style="zoom:50%;" />


### 9. 脚本开发

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf8584ltgj31980cwalo.jpg" alt="image-20200402104047012" style="zoom:50%;" />

### 10. 代码提交

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf8568jmsj30hk0xm41a.jpg" alt="image-20200402104108792" style="zoom:50%;" />



### 11. 对接流程

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf852u7c1j310u0lin96.jpg" alt="image-20200402104130137" style="zoom:50%;" />



### 12. 对接规范

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdf84znun3j310u0e2q94.jpg" alt="image-20200402104145868" style="zoom:50%;" />



## 

